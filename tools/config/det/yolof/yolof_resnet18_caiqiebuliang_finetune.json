{
    "__base__": ["configs/det/models/yolof/yolof_resnet18.json", "tools/config/augmentation/base_augmentation.json"],
    "task": "detection",
    "num_gpus": 1,

    "model": {
    "type": "YOLOF",
    "backbone": {
        "type": "ResNet",
        "depth": 18,
        "num_stages": 4,
        "frozen_stages": 1,
        "norm_cfg": {
            "type": "BN",
            "requires_grad": false
        },
        "norm_eval": true
    },
    "neck": {
        "type": "DilatedEncoder",
        "in_channels": 512,
        "out_channels": 512,
        "block_mid_channels": 128,
        "num_residual_blocks": 4
    },
    "bbox_head": {
        "type": "YOLOFHead",
        "num_classes": 1,
        "in_channels": 512,
        "reg_decoded_bbox": true,
        "anchor_generator": {
            "type": "AnchorGenerator",
            "ratios": [
                1.0
            ],
            "scales": [
                1,
                2,
                4,
                8,
                16
            ],
            "strides": [
                32
            ]
        },
        "bbox_coder": {
            "type": "DeltaXYWHBBoxCoder",
            "target_means": [
                0.0,
                0.0,
                0.0,
                0.0
            ],
            "target_stds": [
                1.0,
                1.0,
                1.0,
                1.0
            ],
            "add_ctr_clamp": true,
            "ctr_clamp": 32
        },
        "loss_cls": {
            "type": "FocalLoss",
            "gamma": 2.0,
            "alpha": 0.25,
            "loss_weight": 1.0,
            "use_sigmoid": true
        },
        "loss_bbox": {
            "type": "GIoULoss",
            "loss_weight": 1.0
        }
    },
    "train_cfg": {
    "score_thr": 0.3,
    "nms": 0.3,
    "max_per_img": 100,
    "assigner": {"type": "UniformAssigner",
        "pos_ignore_thr": 0.15,
        "neg_ignore_thr": 0.7},
    "allowed_border": -1,
    "pos_weight": -1
    },
    "test_cfg": {
        "score_thr": 0.3,
        "nms": 0.3,
        "max_per_img": 100
    }
    },


    "optimizer":{
        "type": "Adam",
        "lr": 0.0001,
        "weight_decay": 0.0001
    },

    "dataset": {
        "input_size": [640, 640],
        "type": "DetectionDataset",
        "train_data_path": "/nas/datasets/huangluyao/detection/cai_qie_bu_liang/train",
        "val_data_path": "/nas/datasets/huangluyao/detection/cai_qie_bu_liang/val",
        "..train_data_path": "D:\\datasets\\huangluyao\\detection\\cai_qie_bu_liang\\train",
        "..val_data_path": "D:\\datasets\\huangluyao\\detection\\cai_qie_bu_liang\\val"
    },

    "loader_cfg": {
        "batch_size": 4,
        "num_workers": 0
    },

    "scheduler": {
        "warm_up_epochs": 5,
        "max_epochs": 100
    },
    "pretrained":"export/detection/YOLOF_ResNet_DilatedEncoder/2021-06-30-09-43-29/checkpoints/val_best.pth"
}
